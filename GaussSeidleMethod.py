def gauss_seidel(A, b, x_0, eps, K):

    n = len(b)
    x_prev = [0.0 for i in range(n)]
    max_prev_err = 0.0
    max_err = 0.0

    for iteration in range(K):

        for i in range(n):
            x_prev[i] = x_0[i]

        for i in range(n):
            dot = 0.0
            for j in range(n):
                if (i != j):
                    dot += (A[i][j] * x_0[j])
            x_0[i] = (b[i] - dot) / A[i][i]

        max_prev_err = max_err
        max_err = 0.0
        for i in range(n):
            temp = abs(x_0[i] - x_prev[i])
            if(x_prev[i] == 0.0):
                x_prev[i] = 1.0
            err = abs(temp/x_prev[i])
            if(err > max_err):
                max_err = err

        if(max_err < eps):
            return (x_0, iteration, max_err)

    return (x_0, K, max_err)


def print_result(result):
    print('----------------------')
    print('finish after {} steps'.format(result[1]))
    print('eps_0 = {}'.format(result[2]))
    for i in range(len(result[0])):
        print('x_{} = {}'.format(i+1, result[0][i]))


# -----------------------------------------------------------------

eps = 1.e-16
K = 1000

# example 1: 2x2
# result ~= [0.8122, -0.6650]

A = [[16,    3],
     [ 7,  -11]]
b = [11, 13]
x_0 = [1, 1]

print_result(gauss_seidel(A, b, x_0, eps, K))

# --------------------------------------------------

# example 2: 4x4
# result = [1, 2, -1, 1]

A = [[ 10,  -1,   2,   0],
     [ -1,  11,  -1,   3],
     [  2,  -1,  10,  -1],
     [  0,   3,  -1,   8]]
b = [6, 25, -11, 15]
x_0 = [0, 0, 0, 0]
x_0 = [1325654, 12, 812, -1223]

print_result(gauss_seidel(A, b, x_0, eps, K))

# --------------------------------------------------

# example 3: 4x4
# result = [2, -2, 2, -2]

A = [[  8,   4,   6,   2],
     [  1,   7,   3,   5],
     [  5,   3,   7,   1],
     [  2,   6,   4,   8]]
b = [16, -16, 16, -16]
x_0 = [0, 0, 0, 0]
x_0 = [1.5, -1, 2, -2.5]
x_0 = [1312, 3423, -2281, 0.00123]

print_result(gauss_seidel(A, b, x_0, eps, K))

# --------------------------------------------------

# example 4: 3x3
# result = [-1, 1, 0]

A = [[   4,   -2,    2],
     [  -2,    2,    2],
     [   2,    2,   14]]
b = [-6, 4, 0]
x_0 = [-1.5, 2, 0]

print_result(gauss_seidel(A, b, x_0, eps, K))

# --------------------------------------------------

# example 5: 5x5
A = [[32.99886,   0.20112,   0.33823,   0.02418,   0.48099],
     [ 0.95706,   0.87389,  22.11674,   0.83306,   0.04143],
     [ 0.13534,  12.93193,   0.66292,   0.61406,   0.65023],
     [ 0.97267,   0.67210,   0.04181,  42.21591,   0.96350],
     [ 0.24198,   0.69004,   0.46666,   0.06648,  12.97124]]
b = [0.34267, 0.94002, 0.46967, 0.10680, 0.61100]
x_0 = [0, 0, 0, 0, 0]

print_result(gauss_seidel(A, b, x_0, eps, K))

# --------------------------------------------------

# example 6: 20x20
A =    [[43.97550 , 0.57822 , 8.07913 , 6.14768 , 2.39273 , 2.88596 , 1.13517 , 3.62395 , 2.30307 , 2.96224 , 1.62045 , 8.09376 , 0.31607 , 1.55130 , 4.19200 , 0.18093 , 8.77532 , 2.20752 , 0.85598 , 3.15096],
        [7.45900 , 71.88733 , 4.44386 , 8.94165 , 1.42718 , 7.11173 , 3.66856 , 6.58780 , 4.25309 , 2.82720 , 4.61975 , 1.52383 , 7.79523 , 1.88114 , 7.38502 , 1.03614 , 1.70432 , 2.05160 , 0.40658 , 2.16440],
        [4.59842 , 3.15213 , 42.08776 , 0.96218 , 5.44735 , 1.24708 , 1.03154 , 0.71151 , 4.30134 , 2.50518 , 1.20833 , 1.77891 , 5.66816 , 7.91857 , 3.53903 , 6.44815 , 1.45638 , 1.18821 , 7.11487 , 4.51205],
        [0.77995 , 0.17832 , 4.61543 , 37.69587 , 5.78744 , 7.22389 , 4.77514 , 8.30086 , 3.44449 , 3.32796 , 8.61917 , 5.36387 , 0.67582 , 6.92877 , 5.59072 , 1.99388 , 3.03630 , 4.71624 , 2.48793 , 6.13068],
        [6.36775 , 4.06500 , 4.23681 , 8.54268 , 216.55458 , 6.64843 , 5.09396 , 2.44239 , 6.48667 , 3.18424 , 8.01851 , 7.86423 , 8.85004 , 2.94930 , 7.68600 , 0.27499 , 1.17636 , 2.35008 , 1.19783 , 7.82553],
        [5.00471 , 2.11284 , 5.54595 , 6.06178 , 6.06972 , 31.38758 , 7.21416 , 1.45556 , 4.16946 , 1.32028 , 1.09568 , 7.93249 , 2.22392 , 7.74885 , 1.21460 , 6.67011 , 1.40589 , 0.26144 , 0.39682 , 2.67820],
        [7.84594 , 7.54829 , 3.63888 , 3.62254 , 1.33770 , 1.24517 , 45.09150 , 4.33744 , 0.02333 , 3.99307 , 5.64707 , 4.38572 , 7.69945 , 4.13911 , 6.60659 , 1.26170 , 5.22192 , 4.57013 , 8.13199 , 4.13967],
        [1.07616 , 5.53583 , 5.60553 , 0.97426 , 4.85151 , 3.38377 , 3.69398 , 82.46482 , 8.06001 , 7.92814 , 3.69933 , 7.68419 , 4.63629 , 3.09229 , 6.09541 , 2.56707 , 2.44938 , 4.73532 , 3.12793 , 6.83317],
        [8.01378 , 1.80910 , 1.56648 , 2.47022 , 2.87572 , 7.98672 , 1.92944 , 1.69763 , 671.57267 , 8.30961 , 6.40052 , 4.30031 , 3.33774 , 6.18334 , 8.73612 , 3.61512 , 3.62916 , 3.66324 , 8.49253 , 4.98487],
        [0.75523 , 2.91244 , 5.67126 , 0.69650 , 5.52294 , 4.61382 , 6.02893 , 5.20692 , 1.20166 , 543.68117 , 1.35098 , 7.39996 , 4.20107 , 7.21643 , 7.57298 , 1.15693 , 8.66911 , 2.25855 , 4.15511 , 2.37382],
        [0.64423 , 7.72383 , 1.71702 , 3.77424 , 0.24472 , 0.66281 , 4.07699 , 7.97225 , 1.36091 , 7.26274 , 65.40637 , 1.31411 , 7.43801 , 0.40133 , 2.31145 , 8.59912 , 3.89614 , 1.94710 , 2.43180 , 8.95421],
        [1.26299 , 0.27034 , 5.24505 , 4.04312 , 1.95758 , 6.28931 , 8.98735 , 4.33936 , 6.28697 , 8.24025 , 8.59628 , 881.11848 , 2.77049 , 3.10878 , 7.68677 , 7.24701 , 2.07047 , 4.06842 , 4.52303 , 1.10050],
        [7.33426 , 3.38807 , 2.52472 , 6.51315 , 4.34543 , 1.26657 , 6.13648 , 4.41299 , 0.86961 , 4.40870 , 2.34436 , 3.20239 , 348.17510 , 0.84223 , 7.49185 , 2.46395 , 0.24173 , 4.68106 , 8.32162 , 6.54718],
        [3.72848 , 2.05052 , 1.85023 , 1.95801 , 1.48224 , 5.39799 , 6.66457 , 8.44652 , 3.81312 , 6.18619 , 4.46929 , 0.76602 , 7.74833 , 234.49453 , 2.56623 , 3.53856 , 4.90782 , 8.24041 , 7.11902 , 4.84210],
        [7.32688 , 0.24045 , 5.53940 , 8.33463 , 7.14362 , 4.41456 , 3.27689 , 6.00301 , 0.74850 , 2.44871 , 7.78721 , 4.00905 , 7.75928 , 4.47661 , 316.53826 , 7.71186 , 0.32685 , 0.47229 , 1.15398 , 8.26208],
        [4.63796 , 2.42211 , 8.65130 , 8.70695 , 4.35065 , 2.43060 , 5.91753 , 4.28250 , 2.24917 , 7.51754 , 5.61486 , 6.43701 , 0.95927 , 6.20995 , 8.81608 , 235.65305 , 7.37445 , 5.21499 , 7.19280 , 1.12149],
        [0.93378 , 7.58900 , 8.56531 , 8.89647 , 0.26322 , 1.17669 , 6.90261 , 7.51115 , 5.18807 , 5.89984 , 3.09950 , 6.71824 , 7.81191 , 7.81392 , 6.85084 , 6.48839 , 418.63121 , 6.93186 , 0.41335 , 1.46507],
        [3.70238 , 8.89924 , 1.80776 , 3.56594 , 7.96233 , 5.86209 , 3.25160 , 0.54776 , 5.80674 , 3.58217 , 0.63019 , 3.55320 , 1.74410 , 8.88918 , 4.30360 , 4.19151 , 1.57652 , 120.88672 , 7.03394 , 6.55966],
        [8.26290 , 7.06220 , 1.28795 , 8.49999 , 7.82546 , 6.66577 , 4.62078 , 5.13709 , 4.30353 , 8.58666 , 8.52659 , 4.98982 , 3.11128 , 1.01707 , 0.69593 , 0.30254 , 5.56322 , 8.87097 , 310.88385 , 5.51035],
        [3.97558 , 8.82093 , 1.39852 , 3.63822 , 8.39044 , 5.22352 , 6.86185 , 5.00390 , 8.39540 , 3.54093 , 0.65999 , 8.93761 , 0.38977 , 1.92679 , 3.40390 , 2.62071 , 2.25771 , 2.05690 , 7.96154 , 223.42142]]
b = [0.97279 , 5.94768 , 0.17522 , 6.69383 , 3.84982 , 2.15458 , 3.53435 , 4.86334 , 8.19206 , 8.46032 , 4.77425 , 5.18921 , 0.92255 , 3.48790 , 1.26319 , 6.78251 , 5.37026 , 0.69417 , 0.56929 , 7.76012]
x_0 = [0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0]

print_result(gauss_seidel(A, b, x_0, eps, K))
